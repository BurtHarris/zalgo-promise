!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define("ZalgoPromise",[],r):"object"==typeof exports?exports.ZalgoPromise=r():e.ZalgoPromise=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}var t={};return r.m=e,r.c=t,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},r.p="",r(r.s="./src/export.js")}({"./src/exceptions.js":function(e,r,t){"use strict";function n(e){if(-1===s.indexOf(e)){s.push(e),setTimeout(function(){throw e},1);for(var r=0;r<i.length;r++)i[r](e)}}function o(e){return i.push(e),{cancel:function(){i.splice(i.indexOf(e),1)}}}Object.defineProperty(r,"__esModule",{value:!0}),r.dispatchPossiblyUnhandledError=n,r.onPossiblyUnhandledException=o;var i=[],s=[]},"./src/export.js":function(e,r,t){"use strict";e.exports=t("./src/promise.js").ZalgoPromise,e.exports.ZalgoPromise=t("./src/promise.js").ZalgoPromise},"./src/promise.js":function(e,r,t){"use strict";function n(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0}),r.ZalgoPromise=void 0;var o=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),i=t("./src/utils.js"),s=t("./src/exceptions.js"),c=function(){function e(r){var t=this;if(n(this,e),this.resolved=!1,this.rejected=!1,this.errorHandled=!1,this.handlers=[],r){var o=void 0,i=void 0,s=!1,c=!1,u=!1;try{r(function(e){u?t.resolve(e):(s=!0,o=e)},function(e){u?t.reject(e):(c=!0,i=e)})}catch(e){return void this.reject(e)}u=!0,s?this.resolve(o):c&&this.reject(i)}}return o(e,[{key:"resolve",value:function(e){if(this.resolved||this.rejected)return this;if((0,i.isPromise)(e))throw new Error("Can not resolve promise with another promise");return this.resolved=!0,this.value=e,this.dispatch(),this}},{key:"reject",value:function(e){var r=this;if(this.resolved||this.rejected)return this;if((0,i.isPromise)(e))throw new Error("Can not reject promise with another promise");if(!e){var t=e&&"function"==typeof e.toString?e.toString():Object.prototype.toString.call(e);e=new Error("Expected reject to be called with Error, got "+t)}return this.rejected=!0,this.error=e,this.errorHandled||setTimeout(function(){r.errorHandled||(0,s.dispatchPossiblyUnhandledError)(e)},1),this.dispatch(),this}},{key:"asyncReject",value:function(e){this.errorHandled=!0,this.reject(e)}},{key:"dispatch",value:function(){var e=this,r=this.resolved,t=this.rejected,n=this.handlers;if(r||t){for(var o=0;o<n.length;){(function(){var s=n[o],c=s.onSuccess,u=s.onError,a=s.promise;o+=1;var f=!1,l=void 0,h=void 0;if(r)try{l=c?c(e.value):e.value}catch(e){f=!0,h=e}else if(t)if(u)try{l=u(e.error)}catch(e){f=!0,h=e}else f=!0,h=e.error;if(l===e)throw new Error("Can not return a promise from the the then handler of the same promise");if(!a)return"continue";f?a.reject(h):(0,i.isPromise)(l)?l.then(function(e){a.resolve(e)},function(e){a.reject(e)}):a.resolve(l)})()}n.length=0}}},{key:"then",value:function(r,t){if(r&&"function"!=typeof r&&!r.call)throw new Error("Promise.then expected a function for success handler");if(t&&"function"!=typeof t&&!t.call)throw new Error("Promise.then expected a function for error handler");var n=new e;return this.handlers.push({promise:n,onSuccess:r,onError:t}),this.errorHandled=!0,this.dispatch(),n}},{key:"catch",value:function(e){return this.then(void 0,e)}},{key:"finally",value:function(r){return this.then(function(t){return e.try(r).then(function(){return t})},function(t){return e.try(r).then(function(){throw t})})}},{key:"toPromise",value:function(){if(!window.Promise)throw new Error("Could not find window.Promise");return window.Promise.resolve(this)}}],[{key:"resolve",value:function(r){return(0,i.isPromise)(r)||r instanceof e?r:(new e).resolve(r)}},{key:"reject",value:function(r){return(new e).reject(r)}},{key:"all",value:function(r){var t=new e,n=r.length,o=[];if(!n)return t.resolve(o),t;for(var i=0;i<r.length;i++)!function(i){e.resolve(r[i]).then(function(e){o[i]=e,0===(n-=1)&&t.resolve(o)},function(e){t.reject(e)})}(i);return t}},{key:"onPossiblyUnhandledException",value:function(e){return(0,s.onPossiblyUnhandledException)(e)}},{key:"try",value:function(r){return e.resolve().then(r)}},{key:"delay",value:function(r){return new e(function(e){setTimeout(e,r)})}},{key:"hash",value:function(r){var t={},n=[];for(var o in r)!function(o){r.hasOwnProperty(o)&&n.push(e.resolve(r[o]).then(function(e){t[o]=e}))}(o);return e.all(n).then(function(){return t})}}]),e}();r.ZalgoPromise=c,(new c).resolve(void 0)},"./src/utils.js":function(e,r,t){"use strict";function n(e){try{if(!e)return!1;if(window.Window&&e instanceof window.Window)return!1;if(window.constructor&&e instanceof window.constructor)return!1;if(o){var r=o.call(e);if("[object Window]"===r||"[object global]"===r||"[object DOMWindow]"===r)return!1}if(e&&e.then instanceof Function)return!0}catch(e){return!1}return!1}Object.defineProperty(r,"__esModule",{value:!0}),r.isPromise=n;var o={}.toString}})});
//# sourceMappingURL=zalgo-promise.min.js.map
//# sourceMappingURL=zalgo-promise.min.js.map